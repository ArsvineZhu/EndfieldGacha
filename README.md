# 终末地卡池 | Endfield Gacha

**文 / A**：[**中文**](README.md) | [**English**](README_en.md)

---

## 终末地卡池

《明日方舟：终末地》的卡池系统，包括但不限于统计、模拟。

---

## 项目介绍

### 1. 环境要求

- **Python** 3.10+ （编写使用3.14.2）

- 依赖库：
      - matplotlib 3.10.8 （统计绘图）
      - rich 14.3.2 （终端美化）
      - tqdm 4.67.3 （进度显示）

### 2. 安装步骤

#### 2.1 克隆仓库

```bash
git clone https://github.com/ArsvineZhu/EndfieldGacha.git
cd EndfieldGacha
```

#### 2.2 安装依赖

```bash
pip install -r requirements.txt
```

### 3. 项目结构

```plaintext
EndfieldGacha/
├── config/                   # 配置文件目录
│   ├── char_pool.json        # 角色卡池配置
│   ├── constants.json        # 常量数值配置
│   ├── gacha_rules.json      # 卡池规则配置
│   └── weapon_pool.json      # 武器卡池配置
├── pic/                      # 图片存储目录
│   ├── char.png              # 角色卡池规则原图
│   ├── weapon.png            # 武器卡池规则原图
│   └── stats/                # 统计结果图片存储目录
├── client.py                 # 控制台客户端
├── core.py                   # 卡池系统核心
└── demo.py                   # 演示与统计
```

---

## 说明

部分图片素材来自于 **《明日方舟：终末地》** 游戏截图。

部分规则在官方的卡池介绍中 **没有详细说明**，因此在开发过程中，我对以下内容进行了 **合理假设**：

### 一、十连保底机制

在角色池中存在“**每十次抽取必定获得五星及以上干员**”的机制，但在那个必定“出五星及以上干员”的一抽中，五星与六星的概率分布没有说明，因此我认为有两种假设：

#### （1）五星挤占四星概率，六星基础概率不变（当前）

e.g. 新卡池的第一次十连，前 9 抽无 5 星及以上干员，则第十抽的概率分布为：

```plaintext
6星：00.80%
5星：91.20%
4星：00.00%
```

e.g. 抽取中途的卡池，前 68 抽无 6 星干员，且前 9 抽无 5 星干员，则下一抽（第69抽）的概率分布为：

```plaintext
6星：20.80%
5星：79.20%
4星：00.00%
```

> **规则**：前 65 抽未出 6 星干员，则从第66抽起，每抽的六星概率增加 5%，直至第 80 抽必出 6 星干员（小保底 / 软保底）

#### （2）五星与六星总概率视作1，按比例重新映射（舍弃）

e.g. 新卡池的第一次十连，前 9 抽无 5 星及以上干员，则第十抽的概率分布为：

```plaintext
6星：~00.91% <- 0.8% / (0.8% + 8%)
5星：~90.91% <- 8% / (0.8% + 8%)
4星：00.00%
```

e.g. 抽取中途的卡池，前 68 抽无 6 星干员，且前 9 抽无 5 星干员，则下一抽（第69抽）的概率分布为：

```plaintext
6星：~72.22% <- 20.8% / (20.8% + 8%)
5星：~27.78% <- 8% / (20.8% + 8%)
4星：00.00%
```

由此看出第二种假设“五星与六星总概率视作1，按比例重新映射”明显**不符合实际体验**~~且与游戏厂家设计意图相悖~~，故此舍弃。

同理，武器池也适用第一种假设解决十连保底问题。

### 二、六星概率提升机制（小保底 / 软保底）

角色卡池中有规则：“前 65 抽未出 6 星干员，则从第66抽起，每抽的**六星概率增加 5%**，直至第 80 抽必出 6 星干员。”此表述未说明六星概率提升后，五星与四星出率如何分布，故此有两种假设：

#### （1）六星挤占其余星级概率

e.g. 抽取中途的卡池，前 68 抽无 6 星干员，且前 9 抽存在 5 星干员（不触发十连保底），则下一抽（第69抽）的概率分布为：

```plaintext
6星：20.80%
5星：08.00%
4星：71.20% （末尾被截断）
```

当抽数更多时：

```plaintext
6星：80.80%
5星：08.00%
4星：11.20% （末尾被截断）
```

进一步地：

```plaintext
6星：95.80%
5星：04.20% （末尾被截断）
4星：00.00% （截断）
```

这种假设会使得抽数提升后，5 星与 4 星的比例失调。但是由于缺乏数据支撑，我无法知晓在 65-80 抽之间抽出 5 星与 4 星的比例如何、现实是否符合此假设。

> **前提**：优先挤占 4 星的概率，总不能先占 5 星的概率吧，不能吧？

#### （2）五星与四星总概率视作1，按比例重新映射（暂定）

e.g. 抽取中途的卡池，前 68 抽无 6 星干员，且前 9 抽存在 5 星干员（不触发十连保底），则下一抽（第69抽）的概率分布为：

```plaintext
6星：20.80%
5星：~06.38% <- 8% * (1 - 20.80%) / (8% + 91.2%)
4星：~72.81% <- 91.2% * (1 - 20.80%) / (8% + 91.2%)
```

此假设保持抽出 5 星与 4 星的比例不变，更有可能是实际使用的方案。

由于缺乏数据支撑，难以看出哪一种假设不符合实际体验，**只能暂定使用第二种**。

---

## 致谢

- **上海鹰角网络科技有限公司**

- **《明日方舟：终末地》**

- ~~给我出馊主意的~~迷迭香厨、白毛猫娘：**宁宁**

- 和我一起讨论的老牌舟友：**LoyaLTY**

- 所有支持我、给予我灵感的开发者、视频创作者

> **注**：以上排名不分先后

> （注：文档及代码部分内容可能由 AI 生成）
